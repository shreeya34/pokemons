<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokémon Search</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .container {
            max-width: 600px;
            margin: auto;
            padding: 20px;
        }
        input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            box-sizing: border-box;
        }
        button {
            width: 100%;
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .pokemon-list {
            margin-top: 20px;
        }
        .pokemon {
            border: 1px solid #ddd;
            margin-bottom: 10px;
            padding: 10px;
            display: flex;
            align-items: center;
        }
        .pokemon img {
            margin-right: 10px;
        }
        .pagination {
            margin-top: 20px;
            text-align: center;
        }
        .pagination button {
            padding: 10px;
            margin: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Pokémon Search</h1>
        <input type="text" id="name" placeholder="Enter Pokémon name">
        <button onclick="searchPokemons()">Search</button>
        <div class="pokemon-list" id="pokemon-list"></div>
        <div class="pagination" id="pagination">
            <button id="prevBtn" onclick="prevPage()">Previous</button>
            <button id="nextBtn" onclick="nextPage()">Next</button>
        </div>
    </div>

    <script>
        let currentPage = 0;
        const limit = 10;
        let isSearching = false;

        // Function to show pagination buttons
        function showPagination() {
            document.getElementById('pagination').style.display = 'block';
        }

        // Function to hide pagination buttons
        function hidePagination() {
            document.getElementById('pagination').style.display = 'none';
        }

        async function searchPokemons() {
            isSearching = true;
            const name = document.getElementById('name').value;
            const response = await fetch(`/api/v1/pokemons/search?name=${name}`);
            const pokemons = await response.json();
            const pokemonList = document.getElementById('pokemon-list');
            
            pokemonList.innerHTML = '';

            if (pokemons.length === 0) {
                pokemonList.innerHTML = '<p>No Pokémon found.</p>';
                hidePagination();
                return;
            }

            pokemons.forEach(pokemon => {
                const pokemonDiv = document.createElement('div');
                pokemonDiv.className = 'pokemon';
                pokemonDiv.innerHTML = `
                    <img src="${pokemon.image_url}" alt="${pokemon.name}">
                    <div>
                        <h2>${pokemon.name}</h2>
                        <p>Type: ${pokemon.type}</p>
                    </div>
                `;
                pokemonList.appendChild(pokemonDiv);
            });

            hidePagination();
        }

        async function fetchPokemons() {
            isSearching = false;
            const response = await fetch(`/api/v1/pokemons?skip=${currentPage * limit}&limit=${limit}`);
            const pokemons = await response.json();
            const pokemonList = document.getElementById('pokemon-list');
            
            pokemonList.innerHTML = '';

            if (pokemons.length === 0) {
                pokemonList.innerHTML = '<p>No Pokémon found.</p>';
                hidePagination();
                return;
            }

            pokemons.forEach(pokemon => {
                const pokemonDiv = document.createElement('div');
                pokemonDiv.className = 'pokemon';
                pokemonDiv.innerHTML = `
                    <img src="${pokemon.image_url}" alt="${pokemon.name}">
                    <div>
                        <h2>${pokemon.name}</h2>
                        <p>Type: ${pokemon.type}</p>
                    </div>
                `;
                pokemonList.appendChild(pokemonDiv);
            });

            showPagination();

            // Check if we need to disable the 'Next' button
            const nextButton = document.getElementById('nextBtn');
            const prevButton = document.getElementById('prevBtn');
            
            // Assume a fixed total count here; adjust based on API response
            const totalCount = 100; 
            const totalPages = Math.ceil(totalCount / limit);

            if (currentPage >= totalPages - 1) {
                nextButton.disabled = true;
            } else {
                nextButton.disabled = false;
            }

            if (currentPage === 0) {
                prevButton.disabled = true;
            } else {
                prevButton.disabled = false;
            }
        }

        function nextPage() {
            currentPage++;
            fetchPokemons();
        }

        function prevPage() {
            if (currentPage > 0) {
                currentPage--;
                fetchPokemons();
            }
        }

        // Initial load for pagination
        fetchPokemons();
    </script>
</body>
</html>
